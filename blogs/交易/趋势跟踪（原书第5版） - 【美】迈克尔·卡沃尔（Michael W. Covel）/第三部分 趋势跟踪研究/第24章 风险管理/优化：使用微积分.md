# 优化：使用微积分

掷硬币的游戏相对简单，因此，我们也可以用微积分来求解最佳的下注比例。我们知道，只需要考虑一次“正面-反面”的投掷对，我们就能够看出最佳的系统是什么，因此，问题可以简化为在一次投掷对中求解。

一次“正面-反面”后的资产：

_S_\=（1+_b_×_P_）×（1-_b_）×_S_0

式中，_S_是一次投掷对后的赌注；_b_是下注比例；_P_是获胜的收益比（2：1）；_S_0是之前的赌注；（1+_b_×_P_）是获胜的影响；（1-_b_）是失败的影响。

因此，一次投掷对的有效收益率_R_为：

_R_\=_S_/_S_0

_R_\=（1+_bP_）×（1-_b_）

_R_\=1-_b_+_bP_\-_b_2_P_

_R_\=1+_b_（_P_\-1）- _b_2_P_

注意，对于较小的_b_，_R_会随_b_（_P_\-1）增大而增大；对于较大的_b_，_R_会随_b_2_P_增大而减小。这就是是胆小交易者原则和胆大交易者原则的数学表示。

我们可以绘制出_R_与_b_的关系图，得到的图形会与上面通过模拟得到的图形相似，我们很容易就能够发现其最大值。我们还能发现，在最大值处斜率等于0，因此我们也可以通过求解斜率为0时的解来得到最大值。

斜率=d_R_/d_b_\=（_P_\-1）-2_bP_\=0，因此：

_b_\=（_P_\-1）/2_P_，对于_P_\=2：1

_b_\=（2-1）/（2×2）=0.25

与之前一样，我们得出的最佳下注比率为25%。