# 多重检验：两种观点

解决统计中的多重检验问题有两种主要方法，被称为“总体错误率”（the family-wise error rate，FWER）和“伪发现率”（the false discovery rate，FDR）。两者之间的区别非常直观。

在考虑总体错误率时，出现单次伪发现是不可接受的。这种检验采用的是非常严格的规则，这在某些情况下是完全适用的。使用FWER，1次伪发现在100次检验中是不可接受的，在1 000 000次检验中同样不可接受。相比之下，伪发现率则是从比例上判断是否“不可接受”。例如，假设在100次检验中出现1次伪发现是不可接受的，那么在1000次检验中出现10次同样是不可接受的。FDR不如FWER那么严格。

那么，哪种方法更合适呢？这取决于要用来做什么。例如，“火星一号”计划在2024年进行火星载人实验，并增加着陆的次数。12在执行任务期间，出现任何关键部件的故障都是不可接受的。一次伪发现就意味着一次严重的失败（我们觉得它的零部件是好的，但可能是坏的，就像我们认为投资经理不错，但可能并非如此）。

最著名的FWER方法被叫作Bonferroni检验。这也是实现起来最简单的一种检验。我们从单次检验取2σ开始。2σ对应的_t_统计量约为2.0。其含义是，单次伪发现的概率仅为5%（请记住，单次伪发现是不可接受的）。同样，我们可以说，我们有95%的信心说没有出现伪发现。

现在假设将检验次数增加到10。Bonferroni检验会针对检验数量进行调整。考虑到检验可能会随机出现显著性结果，因此随着检验数量增加，Bonferroni需要提高置信度。因此，我们要取的显著性水平不是5%，而是应该用5%除以检验次数，即5%/10=0.5%。也就是说，你需要通过10次检验，在99.5%的置信度下，不会出现任何伪发现。就_t_统计量而言，Bonferroni要求10次检验的_t_统计量至少为2.8。对于1000次检验，_t_统计量必须超过4.1。

但是，Bonferroni检验存在三个问题。第一个问题是在FWER和FDR中都存在的问题。我们要做的是评估交易策略，而不是登上火星。做错了交易可能会让你事业受挫、金钱受损，但这不太可能是生死攸关的问题。当然，也可能有人不是这么认为的。

第二个问题与检验之间的相关性有关。使用10个高度相关的变量，和使用10个完全不相关的变量是有很大差异的。考虑极端情况，如果10次检验的相关性为1，那就相当于1次独立检验。

第三个问题是Bonferroni检验忽略了重要信息。自从Holm（1979）的研究以来，我们注意到各个检验统计量中包含着信息，我们可以用这些信息来提高检验的准确性。13Bonferroni检验忽略了这些信息，用最开始的显著性水平除以检验次数来得到粗略的统计值。

让我们先来解决第三个问题。Holm（1979）提供了一种处理检验统计量信息的方法。假设我们现在有10次检验。我们知道，Bonferroni方法对每次检验设定的阈值会是0.005，即0.5%。

Holm方法则首先按照_p_值从最低（有效程度最高）到最高（有效程度最低）对检验进行排序。我们记序列中的第一次检验为_k_\=1，最后一次为_k_\=10。从第一次检验开始，Holm函数会进行如下计算：

[](http://popImage?src='../Images/545-1.jpg')

其中_α_是本例中的显著性水平（0.05），_M_是检验总数。

假设本例中最显著的检验对应的_p_值为0.001。从Holm函数的计算中，我们得出0.05/（10+1-1）=0.005。Holm函数计算得出的值就是_p_值的阈值（观察到的_p_值必须小于该阈值）。第一次检验对应的_p_值为0.001，那么就通过了检验。请注意，第一次检验的阈值与Bonferroni相同。但是，Bonferroni的所有检验用的都是同一个阈值，而在Holm下，其他检验的阈值则有所不同，例如，第二次检验为0.05/（10+1-2）=0.0055。

从第一次检验开始，我们依次比较_p_值和对应的阈值。当我们首次遇到_p_值无法通过检验时，我们将拒绝该检验及之后_p_值更高的检验。

Holm检验能从检验统计量的分布中获取信息。Holm检验不如Bonferroni严格，因为在第一次检验后，其检验通过的条件有所放松。但是，Holm检验仍然属于FWER的范畴。接下来，我们将探索另一种方法。

如前所述，伪发现率的方法允许按预期的比例出现错误（参见Benjamini and Hochberg，1995；Benjamini and Yekutieli，2001）。因此，它不如Bonferroni和Holm检验那么严格。这种方法实现起来也很容易。类似地，我们需要先对检验进行排序。BHY公式为：

[](http://popImage?src='../Images/545-2.jpg')

其中，_c_（_M_）是一个随_M_单调递增的简单函数，当_M_\=10时，_c_（_M_）=2.93。14与Holm检验相反，我们会从最后一次检验（有效程度最低）开始，并根据BHY公式进行计算。

对于最后一次检验，_k_\=_M_\=10，BHY计算得到的阈值为0.05/_c_（10）=0.05/2.93=0.0171。对于倒数第二次检验，_k_\=_M_\-1=9，BHY的阈值为9×0.05/10×2.93=0.0154。请注意，这些阈值比Bonferroni方法给出的阈值0.0050更大（因此条件也更宽松）。

从最后一次检验开始，我们依次将_p_值与其阈值进行比较。当首次出现其_p_值降至阈值以下时，我们就认为该检验及之后_p_值更低的检验有效。

与Holm检验类似，BHY也依赖于检验统计量分布的信息。但是，Holm检验是从最显著的检验开始，而BHY则相反，从最不显著的检验开始。15通常来说，在BHY下我们能接受更多的发现，其原因是BHY允许按照预期比例出现伪发现，这比FWER对伪发现的要求要低。我们认为，BHY方法最适合用于评估交易策略。